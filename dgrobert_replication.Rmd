---
title: "data_analysis_replication"
author: "deving"
date: "4/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

library(tidyverse)

#reading in fire loggers data
f <- "https://raw.githubusercontent.com/DevinGrobert/ada_dgrobert_analysis_replication/main/FireLoggersCombinedData_DRYAD.csv"
fl <- read_csv(f, col_types = NULL, col_names=TRUE)
view(fl)

#reading in seed bank data
s <- "https://raw.githubusercontent.com/DevinGrobert/ada_dgrobert_analysis_replication/main/SeedBankProjectData_Dryad.csv"
sb <- read_csv(s, col_types = NULL, col_names=TRUE)
view(sb)

#DESCRIPTIVE STATISTICS: replicate Table S1
#replace null values in species with functional group
sb<-sb%>%mutate(Species = replace(Species, Species == "NULL", FunctionalGroup[Species=="NULL"]))

#replace grass with graminoid in place of missing grass species
sb<-sb%>%mutate(Species = replace(Species, Species == "Grass", "Graminoid"))

#group by species and treatment
by_sp_tr<-group_by(sb, Species, Treatment)

#create variables for total, max, and frequency.  freq is presence or absence as % of total plots (30 each trt type)
table_s1<- summarise(
  by_sp_tr,
  Total=sum(Individuals),
  Max=max(Individuals),
  Freq=sum(Unique)/30*100
   )

#round down to the nearest integer
table_s1$Freq<-floor(table_s1$Freq)

#separate out controls and treatments, change variable names so they can be rejoined
controls<-filter(table_s1, Treatment == "fuel control")
colnames(controls)<-paste("control_fuel", colnames(controls), sep="_")
controls$Species<-controls$control_fuel_Species
controls$control_fuel_Treatment=NULL
controls$control_fuel_Species<-NULL

treats<-filter(table_s1, Treatment == "fuel addition")
colnames(treats)<-paste("increased_fuel", colnames(treats), sep="_")
treats$Species<-treats$increased_fuel_Species
treats$increased_fuel_Treatment=NULL
treats$increased_fuel_Species<-NULL

#rejoin controls and treatments into a single table
table_s1<-full_join(controls, treats, by = "Species")

#add back functional groups
by_sp<-group_by(sb, Species)
sb_fg<-summarize(
  by_sp,
  FunctionalGroup = FunctionalGroup)
sb_fg<-unique(sb_fg)

table_s1<-full_join(table_s1, sb_fg, by="Species")

#delete oddball row for sp "graminoid" fg "grass" (redundant with sp "graminoid" fg "graminoid")
table_s1<-table_s1[-c(11),]

#reorder columns
table_s1<-table_s1[c(4,8,1,2,3,5,6,7)]
#reorder rows
table_s1<-table_s1[order(table_s1$Species),]
table_s1<-table_s1[c(1,3:5,2,6:9,12,13,11,10),]

#replace NA with 0
table_s1[is.na(table_s1)]<-0

#thats that

view(table_s1)

#VISUALIZATION:Replicate figure s2
